## 데이터 접근 기술 - 스프링 JdbcTemplate

### JdbcTemplate 소개와 설정

- SQL을 직접 사용하는 경우에 스프링이 제공하는 `JdbcTemplate`는 아주 좋은 선택지임

- `JdbcTemplate`의 장점

    1. 설정의 편리함: `spring-jdbc` 라이브러리

    2. 반복 문제 해결: 템플릿 콜백 패턴을 사용해서 대부분의 반복 작업을 대신 처리해줌

- `JdbcTemplate`의 단점

    1. 동적 SQL을 해결하기 어려움


- `JdbcTemplate` 설정

    ```xml
    // build.gradle

    dependencies {

        //JdbcTemplate 추가
        implementation 'org.springframework.boot:spring-boot-starter-jdbc'
        
        //H2 데이터베이스 추가
        runtimeOnly 'com.h2database:h2'
                
    }
    ```

    cf) H2 데이터베이스에 item 테이블 생성

    ```sql
    drop table if exists item CASCADE;
    create table item
    (
        id bigint generated by default as identity,
        item_name varchar(10),
        price integer,
        quantity integer,
        primary key (id)
    );
    ```
---

### JdbcTemplate 적용1 - 기본

- JdbcTemplate을 사용해서 메모리에 저장하던 데이터를 DB에 저장
- `ItemRepository` 인터페이스를 기반으로 JdbcTemplate을 사용하는 새로운 구현체 개발
- 관련 코드는 github 참고

---

### JdbcTemplate 적용2 - 동적 쿼리 문제

- 실습 코드에서 `findAll()` 에서 까다로운 부분은 검색하는 값에 따라서 실행하는 SQL이 동적으로 달라져야 한다는 점임

- 실무에서는 이보다 훨씬 더 복잡한 동적 쿼리들이 사용됨

- 이후 배울 Mybatis의 가장 큰 장점은 SQL을 직접 사용할 때 동적 쿼리를 직접 작성할 수 있음

---

### JdbcTemplate 적용3 - 구성과 실행

- `JdbcTemplateV1Config` 설정하고, `ItemServiceApplication` 에서 아래와 같이 변경해줌

  : `@Import(MemoryConfig.class)` → `@Import(JdbcTemplateConfig.class)`

- `application.properties`  파일에 데이터베이스 관련 설정해줌
    
    ```yaml
    spring.datasource.url=jdbc:h2:tcp://localhost/~/test
    spring.datasource.username=sa
    ```

---